# Персистентное состояние сессии

## Что реализовано

Теперь приложение **сохраняет состояние пользователя** в `sessionStorage`, чтобы при переключении вкладок браузера или временном переходе в другое приложение все настройки оставались на месте.

## Что сохраняется

### В странице "Посещаемость":
- ✅ **Выбранная дата**
- ✅ **Выбранная кафедра**
- ✅ **Выбранный преподаватель**
- ✅ **Выбранное занятие (расписание)**
- ✅ **Поисковый запрос**
- ✅ **Сортировка** (по имени/группе, порядок)

## Как это работает

1. **При выборе параметров** - они автоматически сохраняются в `sessionStorage`
2. **При переключении вкладки** - состояние остаётся в памяти
3. **При возврате на вкладку** - все параметры восстанавливаются
4. **При выходе из системы** - `sessionStorage` очищается
5. **При закрытии браузера** - `sessionStorage` автоматически очищается

## Технические детали

### Новый хук: `usePersistedState`

```typescript
// Для состояния на время сессии (до закрытия браузера)
const [value, setValue] = useSessionState('key', defaultValue);

// Для постоянного состояния (сохраняется после закрытия браузера)
const [value, setValue] = useLocalState('key', defaultValue);
```

### React Query конфигурация

Обновлена конфигурация для лучшей работы с вкладками:

```typescript
{
  refetchOnWindowFocus: true,  // Обновить при возврате на вкладку
  refetchOnReconnect: true,    // Обновить при восстановлении интернета
  refetchOnMount: true,        // Обновить при монтировании
  staleTime: 1000 * 60 * 10,   // Кеш на 10 минут
  gcTime: 1000 * 60 * 60,      // Хранить в памяти 60 минут
}
```

## Преимущества

✅ **Комфортная работа** - не нужно заново выбирать параметры после переключения вкладок
✅ **Быстрая загрузка** - данные показываются мгновенно из кеша
✅ **Автообновление** - свежие данные загружаются в фоне
✅ **Безопасность** - состояние очищается при выходе

## Файлы

- `hooks/usePersistedState.ts` - Хук для персистентного состояния
- `hooks/useAttendanceLogic.ts` - Использует `useSessionState`
- `App.tsx` - Очищает `sessionStorage` при выходе
- `index.tsx` - Конфигурация React Query
